*preserveglobal dir "/Users/gdaudin/Documents/Recherche/GeÃÅographie FrancÃßaise fin XVIIIe/Travail statistique/GraviteÃÅ/"capture program drop reggravprogram reggravversion 9	use "$dir/PourRegTravail.dta", clear	syntax [varlist]		local col =15	display _col(5) _continue	foreach i of local varlist {		display "| `i'" _col(`col') _continue		local col = `col' +10	}	 	display		foreach prod in COT BON QUI MAT EPI TOI LAI CUI FER COM BOI PAP BTR BBR  {				use "$dir/PourRegTravail.dta", clear										quietly keep if prod=="`prod'"						capture drop testSup testCon		sort CDSup		by CDSup: egen testSup=max(nbrliens)		quietly drop if testSup==0						sort CDCon		by CDCon: egen testCon=max(nbrl iens)		quietly drop if testCon==0/*			** Ces trois commandes sont des tests...		xi i.CDSup i.CDCon		logistic nbrliens _ICDCon*  _ICDSup* `varlist'  if prod=="`prod'"		logistic nbrliens _ICDCon*  _ICDSup_2-_ICDSup_78 `varlist'  if prod=="`prod'"*/	**************		*display "Régression"		quietly xi: logistic nbrliens i.CDCon  i.CDSup `varlist'  if prod=="`prod'" /*& _n <= 200*/			local Nbrobs=e(N)		local QuasiR2=e(r2_p)		local col 15		noisily display "`prod'" _column(5) _continue		foreach i of local varlist {						local sign="-"			quietly test `i'= 0						if 	r(p) <= 0.1  local sign="*"			if 	r(p) <= 0.05 local sign="**"			if 	r(p) <= 0.01 local sign="***"						noisily display "| " %4.2f exp(_b[`i']) "`sign'" _col(`col') _continue			local col = `col' +10							/*						noisily display "Prod : " "`prod'" _newline _column(5) "Nobs : " `Nbrobs' /*	 		*/ " ; PsR2 : " %4.3f `QuasiR2' " ; " _newline _column(5)   										noisily display "Variable: " "`i'" "  Coef  : " %4.3f _b[`i'] " ; Odds : " %4.3f exp(_b[`i']) /*		 	*/ " ; ConfInter : " %4.3f exp(_b[`i'])-invF(1,`DegFree',0.95)^0.5*_se[`i'] /*			*/ "-" %4.3f exp(_b[`i']) + invF(1,`DegFree',0.95)^0.5*_se[`i'] /*			*/" ; Std Error : " %5.4f _se[`i'] /*			*/_newline _column(5)/*			*/"----------------------------------------"/*				*/_newline						*/		}		display "| `Nbrobs'|" %4.2f `QuasiR2'	*****	*Pour récolter la valeur des dummies	*Question : faut-il récolter les odds ratio ou les valeurs de base ?	*On fait plutôt les valeurs de base : la régression sera la même qu'avec les odds ratio + log-linérasation	*****	quietly save "$dir/Temp.dta", replace			generate supply_dummy_`prod'=1		foreach i of varlist _ICDSup* {		quietly replace supply_dummy_`prod'=_b[`i'] if `i'==1		}	sort CDSup	quietly by CDSup : keep if _n==1	keep supply_dummy_`prod' CDSup-lnpopSup vSup10_25-vSup50 inseesup	if "`prod'" !="COT" {		merge CDSup using "$dir/Dummies_supply.dta" 		drop _merge		}	sort CDSup		quietly save "$dir/Dummies_supply.dta", replace		use "$dir/Temp.dta", clear	generate cons_dummy_`prod'=1		foreach i of varlist _ICDCon* {		quietly replace cons_dummy_`prod'=_b[`i'] if `i'==1		}	sort CDCon	quietly by CDCon : keep if _n==1	keep cons_dummy_`prod' CDCon-lnpopCon vCon10_25-vCon50 inseecon	if "`prod'" !="COT" {		merge CDCon using "$dir/Dummies_cons.dta"		drop _merge	}	sort CDCon	quietly save "$dir/Dummies_cons.dta", replace							}	end**********************************************Maintenant, programme pour isoler les racines des dummies************************************capture program drop reg_dummiesprogram reg_dummiesversion 9	syntax [varlist], type(string)	*type = soit supply soit cons		use "$dir/Dummies_`type'.dta", clear		local col =15	display _col(5) _continue	foreach i of local varlist {		display "| `i'" _col(`col') _continue		local col = `col' +10	}	 	display		foreach prod in COT BON QUI MAT EPI TOI LAI CUI FER COM BOI PAP BTR BBR  {				use using "$dir/Dummies_`type'.dta", clear					    quietly regress `type'_dummy_`prod' `varlist'			local Nbrobs=e(N)		local R2_adj=e(r2_a)				local col 15		noisily display "`prod'" _column(5) _continue		foreach i of local varlist {						local sign="-"						quietly test `i'= 0						if 	r(p) <= 0.1  local sign="*"			if 	r(p) <= 0.05 local sign="**"			if 	r(p) <= 0.01 local sign="***"									noisily display "| " %4.2f _b[`i'] "`sign'" _col(`col') _continue			local col = `col' +10					}		display "| `Nbrobs'|" %4.2f `R2_adj'		}	end	reggrav lntrsp cinqgf mer gdriv petiteriv canaluse "$dir/Dummies_supply.dta", clearreg_dummies lnpopSup  vSup10_25I vSup25I vSupImp, type(supply)use "$dir/Dummies_cons.dta", clearreg_dummies lnpopCon  vCon10_25 vCon25 , type(cons)*clear*restoreexit*/*invF(1,`degFree',0.95)*/